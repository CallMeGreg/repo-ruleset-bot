---
rulesets:
  - name: "Default Ruleset"
    enforcement_status: "evaluate"
    bypass_list:
      users: ["octocat"]
      teams: ["engineering"]
      roles: ["Organization Admin"]
    target:
      branches:
        all: true
        default_branch: true
        patterns:
          include: ["main"]
          exclude: ["dev"]
      repositories:
        prevent_rename: true
        all: true
        selected:
          include: ["octocat/hello-world"]
          exclude: ["octocat/hello-world"]
        patterns:
          include: ["octocat/*"]
          exclude: ["octocat/*"]
        properties:
          include: ["staging"]
          exclude: ["staging"]
    rules:
      - rule: "restrict creations"
        parameters:
          enabled: true
      - rule: "restrict updates"
        parameters:
          enabled: true
      - rule: "restrict deletions"
        parameters:
          enabled: true
      - rule: "require linear history"
        parameters:
          enabled: true
      - rule: "require signed commits"
        parameters:
          enabled: true
      - rule: "require a pull request before merging"
        parameters:
          enabled: true
          required_approvals: 1
          dismiss_stale_reviews: true
          require_code_owner_reviews: true
          require_approval_of_most_recent_commit: true
          require_conversation_resolution: true
      - rule: "require status checks to pass"
        parameters:
          enabled: true
          require_branches_to_be_up_to_date: true
          do_not_require_status_checks_on_creation: true
          status_checks:
            - name: "ci/circleci"
              source: "GitHub Actions"
      - rule: "block force pushes"
        parameters:
          enabled: true
      - rule: "require workflows to pass before merging"
        parameters:
          enabled: true
          do_not_require_workflows_on_creation: true
          workflows:
            - name: "ci"
              pint_to_commit: true
              repository: "workflows"
              branch_or_tag: "main"
              workflow_file: ".github/workflows/ci.yml"
      - rule: "require code scanning results"
        parameters:
          enabled: true
          tool: "codeql"
          security_alerts: "high or higher"
          alerts: "errors"
    restrictions:
      - restriction: "restrict commit metadata"
        parameters:
          enabled: true
          commit_metadata_restriction:
            - applies_to: "author email"
              requirement: "must start with matching pattern"
              pattern: ".*@github.com"
              description: "All commits must be authored by a GitHub user."
            - applies_to: "commit message"
              requirement: "must not contain"
              pattern: "WIP"
              description: "Commit messages must not contain 'WIP'."
            - applies_to: "author name"
              requirement: "must not be"
              pattern: "root"
              description: "Commits must not be authored by 'root'."
      - restriction: "restrict branch names"
        parameters:
          enabled: true
          branch_name_restriction:
            - applies_to: "branch name"
              requirement: "must not contain a matching pattern"
              pattern: "master"
              description: "Branch names must not contain 'master'."
            - applies_to: "branch name"
              requirement: "must start with matching pattern"
              pattern: "bug/"
              description: "Branch names must start with 'bug/'."